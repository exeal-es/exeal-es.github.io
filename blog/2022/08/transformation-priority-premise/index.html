<!doctype html><html lang=es><head><meta charset=utf-8><title>Transformation Priority Premise | Exeal</title><meta name=description content="Cuanto más especificas son nuestras pruebas unitarias, más genérico es nuestro código"><meta name=author content="Exeal"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta property="og:title" content="Transformation Priority Premise"><meta property="og:description" content="Cuanto más especificas son nuestras pruebas unitarias, más genérico es nuestro código"><meta property="og:type" content="article"><meta property="og:url" content="https://www.exeal.com/blog/2022/08/transformation-priority-premise/"><meta property="og:image" content="https://www.exeal.com/assets/img/blog/posts/woodcraft.png"><meta property="article:section" content="blog"><meta property="article:published_time" content="2022-08-07T23:10:00+00:00"><meta property="article:modified_time" content="2022-08-07T23:10:00+00:00"><meta itemprop=name content="Transformation Priority Premise"><meta itemprop=description content="Cuanto más especificas son nuestras pruebas unitarias, más genérico es nuestro código"><meta itemprop=datePublished content="2022-08-07T23:10:00+00:00"><meta itemprop=dateModified content="2022-08-07T23:10:00+00:00"><meta itemprop=wordCount content="1272"><meta itemprop=image content="https://www.exeal.com/assets/img/blog/posts/woodcraft.png"><meta itemprop=keywords content="tdd,refactoring,"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.exeal.com/assets/img/blog/posts/woodcraft.png"><meta name=twitter:title content="Transformation Priority Premise"><meta name=twitter:description content="Cuanto más especificas son nuestras pruebas unitarias, más genérico es nuestro código"><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css integrity=sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm crossorigin=anonymous><link rel=stylesheet href=https://www.exeal.com/scss/main.css><link rel=icon type=image/png href=/assets/img/favicon.png><link rel=apple-touch-icon href=/assets/img/apple-touch-icon.png><script async src="https://www.googletagmanager.com/gtag/js?id=UA-172984297-1"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-172984297-1")</script><script type=text/javascript id=hs-script-loader async defer src=//js.hs-scripts.com/8231847.js></script>
<link rel=stylesheet type=text/css href=https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css><link rel=stylesheet href=https://www.exeal.com/scss/blog.css><link rel=stylesheet href=https://www.exeal.com/scss/hero.css></head><body><nav class="navbar navbar-light navbar-expand-lg navbar-shrink"><div class=container><div class="d-flex flex-row"><a href=/ class=navbar-brand><img src=/assets/img/logo-exeal-header-black.svg alt=Exeal></a>
<a href=/blog/ class=navbar-brand><img src=/assets/img/blog/logo-blog.svg alt=Blog></a></div><button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarTogglerDemo01 aria-controls=navbarTogglerDemo01 aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarTogglerDemo01><ul class="navbar-nav ml-auto"><li class=nav-item><a class="nav-link nav-button" href=/lista-de-correo/>Suscríbete a la newsletter</a></li></ul></div></div></nav><header class="hero hero-bg-img" style=background-image:url(/assets/img/blog/posts/woodcraft.png)><div class="hero-bg-img-mask bg-mask"><div class="container h-100"><div class="row h-100 align-items-center"><div class="col-12 text-center"><ul class="tags tags-light"><li><a href=https://www.exeal.com/tags/tdd/>#tdd</a></li><li><a href=https://www.exeal.com/tags/refactoring/>#refactoring</a></li></ul><h1><span class=underline>Transformation Priority Premise</span></h1><h2></h2><p class=date>2022/08/07</p><p><a data-scroll=sect-body href=#><img class=arrow-down src=/assets/img/arrow-down-secondary.svg></a></p></div></div></div></div></header><section id=sect-body><div class=container><article><h1 id=transformation-priority-premise>Transformation Priority Premise</h1><p><a href=https://es.wikipedia.org/wiki/Robert_C._Martin>El tio bob</a> lleva muchos años diciendo que mientras las pruebas son más específicas, el código se hace más genérico. Y es que de tanto refactorizar, de tanto modificar el código con esas pequeñas mejoras de estructura sin cambiar su comportamiento exterior, van ocurriendo transformaciones en el código de producción que parecen seguir un cierto camino ordenado.</p><p>Esto parece generar una lista de transformaciones ordenada que nos puede servir de guía para alcanzar una implementación más genérica. Además nos ayuda a dar pequeños pasos de bebé al objetivo deseado, cosa difícil de asimilar en TDD al inicio.</p><p>Entonces, ¿cómo funciona esta técnica? 🤔
Una vez que tenemos nuestro test en rojo, lo que hacemos es implementar nuestro código productivo con el mínimo código posible, con lo cual seguimos la lista de arriba hacia abajo, intentando poner en verde nuestro test.</p><p>Los elementos superiores de la lista tienen más prioridad que los elementos de abajo.</p><table><thead><tr><th>Transformación</th><th>Descripción</th></tr></thead><tbody><tr><td>{}&ndash;>cero</td><td>sin código en absoluto -> código que emplea nil</td></tr><tr><td>nil->constante</td><td>nuestras asignaciones a nulo -> cambiar por constantes</td></tr><tr><td>constante->constante+</td><td>una constante simple a una constante más compleja</td></tr><tr><td>constante->escalar</td><td>reemplazar una constante con una variable o un argumento</td></tr><tr><td>cambio de estado</td><td>agregando más declaraciones incondicionales</td></tr><tr><td>sentencia no condicional->if</td><td>dividir la ruta de ejecución</td></tr><tr><td>escalar->array</td><td>podemos modificar nuestra variable por un conjunto más genérico</td></tr><tr><td>array->contenedor</td><td>podemos reemplazar nuestro array a algo más genérico como una lista</td></tr><tr><td>sentencia->recursividad</td><td>podemos modificar nuestra sentencia por algún código que se llame a si mismo</td></tr><tr><td>if->while</td><td>podemos hacer condicionantes más genéricos usando bucles</td></tr><tr><td>expresión->función</td><td>reemplazar una expresión con una función o algoritmo</td></tr><tr><td>variable->asignación</td><td>reemplazar el valor de una variable</td></tr><tr><td>caso</td><td>agregando un case (o un else) por un switch o un if existente</td></tr></tbody></table><h2 id=cómo-funciona>¿Cómo funciona?</h2><p>Por ejemplo, para la kata de números romanos, donde dado un dígito, debemos convertirlo en un número con notación romana, podríamos partir intentando convertir 1 en I. Para ello usamos la primera transformación, retornar null:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>roman</span>(){
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>No es suficiente, nuestra prueba falla. Ahora podemos usar la siguiente transformación, retornar una constante:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>roman</span>(){
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;I&#34;</span>;
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>Nuestra prueba pasa. Para la segunda prueba que intenta convertir 2 en II, podemos usar la siguiente transformación; pasar de constante a variable:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>roman</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>result</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;I&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>result</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>No es suficiente, nuestra prueba sigue fallando. Podemos intentar añadir algo de poder de cómputo en nuestra siguiente transformación sugerida:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>roman</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>result</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;I&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>result</span> <span style=color:#f92672>+=</span> <span style=color:#e6db74>&#34;I&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>result</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Soluciona la prueba de convertir 2 en II, pero rompe la prueba de convertir 1 en I. Así que pasamos a la siguiente transformación, incluir condicionantes:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>roman</span>(<span style=color:#a6e22e>digit</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>result</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;I&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>digit</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>result</span> <span style=color:#f92672>+=</span> <span style=color:#e6db74>&#34;I&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>result</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Listo, ya tenemos nuestras pruebas pasando. No hay mucho que limpiar aún. Nuestra siguiente prueba es que 3 retorne III, así que podríamos usar otro condicional y llenar nuestro código de if&rsquo;s, ó pasar a la siguiente transformación y usar arrays:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>roman</span>(<span style=color:#a6e22e>digit</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>romans</span> <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;I&#34;</span>, <span style=color:#e6db74>&#34;II&#34;</span>, <span style=color:#e6db74>&#34;III&#34;</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>romans</span>[<span style=color:#a6e22e>digit</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Genial! todas las pruebas pasando y nuestro código cada vez más genérico y limpio. Hay algo que molesta a la vista y que veremos en un minuto. Siguiente prueba. Convertir 4 en IV.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>roman</span>(<span style=color:#a6e22e>digit</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>romans</span> <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;I&#34;</span>, <span style=color:#e6db74>&#34;II&#34;</span>, <span style=color:#e6db74>&#34;III&#34;</span>, <span style=color:#e6db74>&#34;IV&#34;</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>romans</span>[<span style=color:#a6e22e>digit</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Nos basta con agregar el nuevo elemento al array, pero hay cosas que no se sienten bien. Ese &ldquo;digit - 1&rdquo; duele un poco a la vista, no se entiende muy bien. Podemos usar la siguiente transformación y ver qué ocurre:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>roman</span>(<span style=color:#a6e22e>digit</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>romans</span> <span style=color:#f92672>=</span> {<span style=color:#ae81ff>1</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;I&#34;</span>, <span style=color:#ae81ff>2</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;II&#34;</span>, <span style=color:#ae81ff>3</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;III&#34;</span>, <span style=color:#ae81ff>4</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;IV&#34;</span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>romans</span>[<span style=color:#a6e22e>digit</span>];
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Genial!, nuestras pruebas pasan y nuestros ojos están más relajados, aunque esto de estar agregando entrada/valor para cada prueba no se siente bien. El 2 y el 3 parecen ser simplemente casos de agregar tantas &ldquo;I&rdquo; como hagan falta&mldr; el caso del 4 parece ser especial, así que:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>roman</span>(<span style=color:#a6e22e>digit</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>romans</span> <span style=color:#f92672>=</span> {<span style=color:#ae81ff>1</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;I&#34;</span>, <span style=color:#ae81ff>4</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;IV&#34;</span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>digit</span> <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>romans</span>){
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>romans</span>[<span style=color:#a6e22e>digit</span>];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>roman</span>(<span style=color:#a6e22e>digit</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>+</span> <span style=color:#a6e22e>romans</span>[<span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Hemos agregado código más genérico para el cálculo de 2 y 3 a través de algo de recursividad. Para la prueba donde 5 retorna V podemos agregar el valor al listado:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>roman</span>(<span style=color:#a6e22e>digit</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>romans</span> <span style=color:#f92672>=</span> {<span style=color:#ae81ff>1</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;I&#34;</span>, <span style=color:#ae81ff>4</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;IV&#34;</span>, <span style=color:#ae81ff>5</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;V&#34;</span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>digit</span> <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>romans</span>){
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>romans</span>[<span style=color:#a6e22e>digit</span>];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>roman</span>(<span style=color:#a6e22e>digit</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>+</span> <span style=color:#a6e22e>romans</span>[<span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Este código es suficientemente bueno para que pasen las pruebas de 6, 7 y 8 y nuestro siguiente problema lo tenemos con la prueba donde 9 debe retornar IX. Esto se parece mucho al caso del 4 donde se retorna IV. Así que al agregar el 9 al listado:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>roman</span>(<span style=color:#a6e22e>digit</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>romans</span> <span style=color:#f92672>=</span> {<span style=color:#ae81ff>1</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;I&#34;</span>, <span style=color:#ae81ff>4</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;IV&#34;</span>, <span style=color:#ae81ff>5</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;V&#34;</span>, <span style=color:#ae81ff>9</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;IX&#34;</span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>digit</span> <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>romans</span>){
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>romans</span>[<span style=color:#a6e22e>digit</span>];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>roman</span>(<span style=color:#a6e22e>digit</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>+</span> <span style=color:#a6e22e>romans</span>[<span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>No solo pasa la prueba, sino que comenzamos a intuir que algo ocurre una y otra y otra vez. Incluimos el 10:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>roman</span>(<span style=color:#a6e22e>digit</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>romans</span> <span style=color:#f92672>=</span> {<span style=color:#ae81ff>1</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;I&#34;</span>, <span style=color:#ae81ff>4</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;IV&#34;</span>, <span style=color:#ae81ff>5</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;V&#34;</span>, <span style=color:#ae81ff>9</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;IX&#34;</span>, <span style=color:#ae81ff>10</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;X&#34;</span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>digit</span> <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>romans</span>){
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>romans</span>[<span style=color:#a6e22e>digit</span>];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>roman</span>(<span style=color:#a6e22e>digit</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>+</span> <span style=color:#a6e22e>romans</span>[<span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Y nuestro siguiente caso de fallo es el 14, con esta solución retorna XIIII y no XIV, así que aprovechamos a agregar algo más de cómputo:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>roman</span>(<span style=color:#a6e22e>digit</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>romans</span> <span style=color:#f92672>=</span> {<span style=color:#ae81ff>1</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;I&#34;</span>, <span style=color:#ae81ff>4</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;IV&#34;</span>, <span style=color:#ae81ff>5</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;V&#34;</span>, <span style=color:#ae81ff>9</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;IX&#34;</span>, <span style=color:#ae81ff>10</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;X&#34;</span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>digit</span> <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>romans</span>){
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>romans</span>[<span style=color:#a6e22e>digit</span>];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>digit</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>10</span>){
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>romans</span>[<span style=color:#ae81ff>10</span>] <span style=color:#f92672>+</span> <span style=color:#a6e22e>roman</span>(<span style=color:#a6e22e>digit</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>10</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>digit</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>5</span>){
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>romans</span>[<span style=color:#ae81ff>5</span>] <span style=color:#f92672>+</span> <span style=color:#a6e22e>roman</span> (<span style=color:#a6e22e>digit</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>digit</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span>){
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>romans</span>[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>+</span> <span style=color:#a6e22e>roman</span> (<span style=color:#a6e22e>digit</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Esto hace que las pruebas pasen y nos da una idea de un patrón que se está generando. Imaginemos que tenemos el número 30, esto realizaría muchos cómputos y reservas de memoria para restar 10 y calcular 20 para hacer lo mismo, restar 10 y calcular 10. Parece que es poco eficiente, así que podemos hacer más genérico nuestro if con una transformación a while:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>roman</span>(<span style=color:#a6e22e>digit</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>romans</span> <span style=color:#f92672>=</span> {<span style=color:#ae81ff>1</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;I&#34;</span>, <span style=color:#ae81ff>4</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;IV&#34;</span>, <span style=color:#ae81ff>5</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;V&#34;</span>, <span style=color:#ae81ff>9</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;IX&#34;</span>, <span style=color:#ae81ff>10</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;X&#34;</span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>digit</span> <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>romans</span>){
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>romans</span>[<span style=color:#a6e22e>digit</span>];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>result</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span>(<span style=color:#a6e22e>digit</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>10</span>){
</span></span><span style=display:flex><span>       <span style=color:#a6e22e>result</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>romans</span>[<span style=color:#ae81ff>10</span>]
</span></span><span style=display:flex><span>       <span style=color:#a6e22e>digit</span> <span style=color:#f92672>-=</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span>(<span style=color:#a6e22e>digit</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>9</span>){
</span></span><span style=display:flex><span>       <span style=color:#a6e22e>result</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>romans</span>[<span style=color:#ae81ff>9</span>]
</span></span><span style=display:flex><span>       <span style=color:#a6e22e>digit</span> <span style=color:#f92672>-=</span> <span style=color:#ae81ff>9</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span>(<span style=color:#a6e22e>digit</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>5</span>){
</span></span><span style=display:flex><span>       <span style=color:#a6e22e>result</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>romans</span>[<span style=color:#ae81ff>5</span>]
</span></span><span style=display:flex><span>       <span style=color:#a6e22e>digit</span> <span style=color:#f92672>-=</span> <span style=color:#ae81ff>5</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span>(<span style=color:#a6e22e>digit</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>4</span>){
</span></span><span style=display:flex><span>       <span style=color:#a6e22e>result</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>romans</span>[<span style=color:#ae81ff>4</span>]
</span></span><span style=display:flex><span>       <span style=color:#a6e22e>digit</span> <span style=color:#f92672>-=</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span>(<span style=color:#a6e22e>digit</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>1</span>){
</span></span><span style=display:flex><span>       <span style=color:#a6e22e>result</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>romans</span>[<span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>       <span style=color:#a6e22e>digit</span> <span style=color:#f92672>-=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>result</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Esto nos da una idea de que para hacer este código más genérico, nos basta con iterar (nueva transformación) sobre el listado de números de referencia. Para que tenga sentido debemos ordenarlos de mayor a menor como nos indican las pistas de nuestro código, por lo pronto no me complico la vida y genero un array con los valores ordenados:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>romans</span> <span style=color:#f92672>=</span> {<span style=color:#ae81ff>1</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;I&#34;</span>, <span style=color:#ae81ff>4</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;IV&#34;</span>, <span style=color:#ae81ff>5</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;V&#34;</span>, <span style=color:#ae81ff>9</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;IX&#34;</span>, <span style=color:#ae81ff>10</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#34;X&#34;</span>};
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>sorted_special_numbers</span> <span style=color:#f92672>=</span> [<span style=color:#ae81ff>10</span>,<span style=color:#ae81ff>9</span>,<span style=color:#ae81ff>5</span>,<span style=color:#ae81ff>4</span>,<span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>roman</span>(<span style=color:#a6e22e>digit</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>digit</span> <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>romans</span>){
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>romans</span>[<span style=color:#a6e22e>digit</span>];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>result</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sorted_special_numbers</span>.<span style=color:#a6e22e>forEach</span>(<span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>number</span>) {
</span></span><span style=display:flex><span>       <span style=color:#66d9ef>while</span>(<span style=color:#a6e22e>digit</span> <span style=color:#f92672>&gt;=</span> <span style=color:#a6e22e>number</span>) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>result</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>romans</span>[<span style=color:#a6e22e>number</span>]
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>digit</span> <span style=color:#f92672>-=</span> <span style=color:#a6e22e>number</span>;
</span></span><span style=display:flex><span>       }
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>result</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=conclusiones>Conclusiones</h2><p>TPP promete mejorar la eficiencia de los desarrolladores que trabajan en un entorno TDD al ayudar a evitar impases. Proporciona medios útiles para superar los obstáculos en el diseño e implementación de pruebas unitarias. Aunque la lista específica de transformaciones aplicadas puede variar entre los desarrolladores, la premisa de priorizar la simplicidad establece un sistema que es fácil de seguir.
Es probable que la técnica aumente en importancia y aplicabilidad a medida que se estudia, mejora y formaliza.</p><p>Espero que hayas podido disfrutar de este post, ¡nos estamos viendo!</p><p>¡Saludos! 🖖</p></article></div><div class=container><div class="row h-100 align-items-center"><div class="col-12 text-center"><ul class="tags tags-dark"><li><a href=https://www.exeal.com/tags/tdd/>#tdd</a></li><li><a href=https://www.exeal.com/tags/refactoring/>#refactoring</a></li></ul><div class=post-author><img class=rounded-circle src><div class=post-author-name><h2></h2><p></p><ul class="social-icons list-inline"><li class=list-inline-item><a target=_blank href><img src=/assets/img/blog/social-icons/icon-twitter.svg></a></li><li class=list-inline-item><a target=_blank href><img src=/assets/img/blog/social-icons/icon-linkedin.svg></a></li><li class=list-inline-item><a target=_blank href><img src=/assets/img/blog/social-icons/icon-github.svg></a></li><li class=list-inline-item><a target=_blank href=mailto:><img src=/assets/img/blog/social-icons/icon-email.svg></a></li></ul></div></div><div class=addthis_inline_share_toolbox></div></div></div></div></section><footer class=black><div class=container><div class="row align-items-center"><div class="col-lg-6 text-lg-left"><a href=/><img src=/assets/img/logo-exeal-footer.svg alt=Exeal></a><p><a href=/legal/legal-notice/>Aviso legal</a> |
<a href=/legal/cookie-policy/>Política de cookies</a> |
<a href=/legal/privacy-policy/>Política de privacidad</a></p></div><div class="col-lg-6 social-media"><ul class="list-inline text-lg-right mt-3 mt-lg-0"><li class=list-inline-item><a target=_blank href=https://twitter.com/exeal><img src=/assets/img/social/twitter.svg></a></li><li class=list-inline-item><a target=_blank href=https://www.linkedin.com/company/exeal/><img src=/assets/img/social/linkedin.svg></a></li><li class=list-inline-item><a target=_blank href=https://www.youtube.com/channel/UCxVspi-mashFr1RPGxSxEPA><img src=/assets/img/social/youtube.svg></a></li><li class=list-inline-item><a target=_blank href=https://github.com/exeal-es><img src=/assets/img/social/github.svg></a></li><li class=list-inline-item><a target=_blank href=mailto:hola@exeal.com><img src=/assets/img/social/email.svg></a></li></ul></div></div></div></footer><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js integrity=sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q crossorigin=anonymous></script>
<script src=https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js integrity=sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl crossorigin=anonymous></script>
<script src=/assets/js/scroll.js></script>
<script src=/assets/js/redirect.js></script>
<script src=/assets/js/console.js></script>
<script>function loadScript(t){var n=document.getElementsByTagName("head")[0],e=document.createElement("script");e.type="text/javascript",e.src="https://tracker.metricool.com/resources/be.js",e.onreadystatechange=t,e.onload=t,n.appendChild(e)}loadScript(function(){beTracker.t({hash:"45d30dfb71957d625ad900e4772a2d6a"})})</script><div class="modal fade" id=newsletter-modal tabindex=-1 role=dialog aria-hidden=true><div class="modal-dialog modal-lg modal-dialog-centered" role=document><div class=modal-content><div class=box style=margin:1.5rem;padding:3rem><div class="flap flap-top-right"></div><h2>¡No te vayas sin suscribirte a nuestra <em>lista de correo</em>!</h2><p>Recibe cada semana en tu bandeja de entrada contenido de valor sobre <em>buenas prácticas de desarrollo de software</em>. Cancela cuando quieras.</p><div id=mc_embed_shell><link href=//cdn-images.mailchimp.com/embedcode/classic-061523.css rel=stylesheet type=text/css><div id=mc_embed_signup><form action="https://exeal.us10.list-manage.com/subscribe/post?u=b43f7982f87d38bbb55bc64ae&id=a85eab802a&f_id=008ed9e5f0" method=post id=mc-embedded-subscribe-form name=mc-embedded-subscribe-form class=validate target=_blank><div id=mc_embed_signup_scroll><div class=indicates-required><span class=asterisk>*</span> campos requeridos</div><div class=mc-field-group><label for=mce-EMAIL>Tu mejor email <span class=asterisk>*</span></label><input type=email name=EMAIL class="required email" id=mce-EMAIL required></div><div class=mc-field-group><label for=mce-FNAME>Tu nombre <span class=asterisk>*</span></label><input type=text name=FNAME class="required text" id=mce-FNAME required></div><div id=mce-responses class="clear foot"><div class=response id=mce-error-response style=display:none></div><div class=response id=mce-success-response style=display:none></div></div><div aria-hidden=true style=position:absolute;left:-5000px>/* real people should not fill this in and expect good things
- do not remove this or risk form bot signups */
<input type=text name=b_b43f7982f87d38bbb55bc64ae_a85eab802a tabindex=-1></div><div class=optionalParent><div class="clear foot"><input type=submit name=subscribe id=mc-embedded-subscribe class=btn-submit value=Suscribirme><p style="margin:0 auto"><a href=http://eepurl.com/iDVZqA title="Mailchimp: marketing por correo electrónico fácil y divertido"><span style=display:inline-block;background-color:transparent;border-radius:4px><img class=refferal_badge src=https://digitalasset.intuit.com/render/content/dam/intuit/mc-fe/en_us/images/intuit-mc-rewards-text-dark.svg alt="Intuit Mailchimp" style="width:220px;height:40px;display:flex;padding:2px 0;justify-content:center;align-items:center"></span></a></p></div></div></div></form></div><script type=text/javascript src=//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js></script>
<script type=text/javascript>(function(){window.fnames=new Array,window.ftypes=new Array,fnames[0]="EMAIL",ftypes[0]="email",fnames[1]="FNAME",ftypes[1]="text",fnames[2]="LNAME",ftypes[2]="text",fnames[5]="JOBTITLE",ftypes[5]="text",fnames[6]="COMPANY",ftypes[6]="text",fnames[3]="ADDRESS",ftypes[3]="address",fnames[4]="PHONE",ftypes[4]="phone"})(jQuery);var $mcj=jQuery.noConflict(!0)</script></div></div></div></div></div><script>if(typeof Storage!="undefined"){function showPopup(){window.setTimeout(function(){$("#newsletter-modal").modal("show"),sessionStorage.setItem("popup","hide")},1e4)}sessionStorage.getItem("popup")||sessionStorage.setItem("popup","show"),sessionStorage.getItem("popup")=="show"&&showPopup()}</script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5f2bf2edad69c454"></script></body></html>