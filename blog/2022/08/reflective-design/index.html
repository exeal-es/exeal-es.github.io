<!doctype html><html lang=es><head><meta charset=utf-8><title>Prepara tu código para lo que venga con Reflective Design | Exeal</title><meta name=description content="Cómo evitar que el código se deteriore aplicando el mindset de Simple Design"><meta name=author content="Exeal"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta property="og:title" content="Prepara tu código para lo que venga con Reflective Design"><meta property="og:description" content="Cómo evitar que el código se deteriore aplicando el mindset de Simple Design"><meta property="og:type" content="article"><meta property="og:url" content="https://www.exeal.com/blog/2022/08/reflective-design/"><meta property="og:image" content="https://www.exeal.com/assets/img/blog/posts/reflection.jpeg"><meta property="article:section" content="blog"><meta property="article:published_time" content="2022-11-10T00:07:00+01:00"><meta property="article:modified_time" content="2022-11-10T00:07:00+01:00"><meta itemprop=name content="Prepara tu código para lo que venga con Reflective Design"><meta itemprop=description content="Cómo evitar que el código se deteriore aplicando el mindset de Simple Design"><meta itemprop=datePublished content="2022-11-10T00:07:00+01:00"><meta itemprop=dateModified content="2022-11-10T00:07:00+01:00"><meta itemprop=wordCount content="1058"><meta itemprop=image content="https://www.exeal.com/assets/img/blog/posts/reflection.jpeg"><meta itemprop=keywords content="legacy,refactoring,oo-design,"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.exeal.com/assets/img/blog/posts/reflection.jpeg"><meta name=twitter:title content="Prepara tu código para lo que venga con Reflective Design"><meta name=twitter:description content="Cómo evitar que el código se deteriore aplicando el mindset de Simple Design"><link rel=stylesheet href=https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css integrity=sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm crossorigin=anonymous><link rel=stylesheet href=https://www.exeal.com/scss/main.css><link rel=icon type=image/png href=/assets/img/favicon.png><link rel=apple-touch-icon href=/assets/img/apple-touch-icon.png><script async src="https://www.googletagmanager.com/gtag/js?id=UA-172984297-1"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-172984297-1")</script><script type=text/javascript id=hs-script-loader async defer src=//js.hs-scripts.com/8231847.js></script>
<link rel=stylesheet type=text/css href=https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css><link rel=stylesheet href=https://www.exeal.com/scss/blog.css><link rel=stylesheet href=https://www.exeal.com/scss/hero.css></head><body><nav class="navbar navbar-light navbar-expand-lg navbar-shrink"><div class=container><div class="d-flex flex-row"><a href=/ class=navbar-brand><img src=/assets/img/logo-exeal-header-black.svg alt=Exeal></a>
<a href=/blog/ class=navbar-brand><img src=/assets/img/blog/logo-blog.svg alt=Blog></a></div><button class=navbar-toggler type=button data-toggle=collapse data-target=#navbarTogglerDemo01 aria-controls=navbarTogglerDemo01 aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarTogglerDemo01><ul class="navbar-nav ml-auto"><li class=nav-item><a class="nav-link nav-button" href=/lista-de-correo/>Suscríbete a la newsletter</a></li></ul></div></div></nav><header class="hero hero-bg-img" style=background-image:url(/assets/img/blog/posts/reflection.jpeg)><div class="hero-bg-img-mask bg-mask"><div class="container h-100"><div class="row h-100 align-items-center"><div class="col-12 text-center"><ul class="tags tags-light"><li><a href=https://www.exeal.com/tags/legacy/>#legacy</a></li><li><a href=https://www.exeal.com/tags/refactoring/>#refactoring</a></li><li><a href=https://www.exeal.com/tags/oo-design/>#oo-design</a></li></ul><h1><span class=underline>Prepara tu código para lo que venga con Reflective Design</span></h1><h2>Pedro Pardal</h2><p class=date>2022/11/10</p><p><a data-scroll=sect-body href=#><img class=arrow-down src=/assets/img/arrow-down-secondary.svg></a></p></div></div></div></div></header><section id=sect-body><div class=container><article><p>¿Por qué los proyectos greenfield acaban convirtiéndose poco a poco en código legacy, difícil de extender y mantener?</p><p>En un <a href=https://www.exeal.com/blog/2021/03/por-que-el-codigo-degenera/>anterior post</a> comentábamos que existen fuerzas, como los requisitos cambiantes, los deadlines, o la naturaleza social del desarrollo de software, que hace que <strong>el código de nuestros proyectos poco a poco se vaya deteriorando si no hacemos nada al respecto</strong>. Por tanto, como desarrolladores debemos ejercer fuerzas opuestas para contrarrestar este efecto.</p><p>Una de las estrategias que podemos adoptar es el mindset de <a href=https://wiki.c2.com/?DoSimpleThings>Simple Design</a>. Sorprendentemente para muchos, esto no es nada nuevo: <a href=https://twitter.com/KentBeck>Kent Beck</a> ya hablaba de esto en el libro de <a href=https://www.amazon.es/Extreme-Programming-Explained-Embrace-Embracing/dp/0321278658>Extreme Programming Explained</a> de 1999, hace más de 22 años.</p><h2 id=las-4-reglas-de-diseño-simple>Las 4 reglas de diseño simple</h2><p><a href=https://twitter.com/mfeathers>Michael Feathers</a>, el autor del libro <a href=https://www.amazon.es/Working-Effectively-Legacy-Robert-Martin/dp/0131177052>Working Effectively with Legacy Code</a>, nos dice que “código legacy es código que no tiene tests”. Cuando yo hablo sobre código legacy <a href=https://www.exeal.com/cursos/legacy-code/>a nuestros alumnos</a>, les doy una definición un poco más amplia: “código legacy es código que no cumple las <a href=https://martinfowler.com/bliki/BeckDesignRules.html>4 rules of simple design</a> - 4RSD” de Kent Beck. Estas reglas son las siguientes:</p><ul><li>Que el código tenga tests (y estén en verde). Esta sería la definición de Michael Feathers.</li><li>Que minimice la duplicidad.</li><li>Que maximice la expresividad.</li><li>Que minimice la complejidad.</li></ul><p>La experiencia nos dice que una de las mejores formas de conseguir cumplir estos 4 criterios a la vez en nuestro código, y así evitar que éste se deteriore, es desarrollar usando <a href=https://www.exeal.com/cursos/test-driven-development/>Test Driven Development</a>.</p><h2 id=tdd-se-ha-malinterpretado>TDD se ha malinterpretado</h2><p>A pesar de su nombre, Test Driven Development <strong>no es una técnica de testing</strong>. El objetivo de TDD no es conseguir un 100% de cobertura, aunque este sea un efecto lateral de usar la técnica.</p><p>Por el contrario, TDD es un flujo de trabajo cuyo objetivo es conseguir <strong>la solución más simple</strong> dada una especificación a un problema.</p><p>En el <a href=https://www.exeal.com/blog/2021/03/por-que-el-codigo-degenera/>primer post</a> de esta serie sobre código legacy, comentábamos que aprendíamos por error a sacar la bola de cristal para preparar nuestro diseño para el futuro. Y que normalmente nos equivocábamos y acabábamos haciendo el problema más grande.</p><p>Muchos desarrolladores que se acercan por primera vez al TDD, comienzan diseñando el código en su cabeza, y luego escriben los tests que le van a llevar a implementar ese diseño, en lugar de tests que capturen los requisitos. Por tanto, los tests quedan acoplados a la implementación, <strong>alejándose de esa promesa de un diseño simple</strong>.</p><p>¿Qué es lo que TDD sugiere realmente? Que para pasar de <strong>rojo a verde</strong>, no hay que diseñar, sino únicamente escribir el <strong>código mínimo para que el test pase</strong>.</p><p>La actividad de diseño en TDD ocurre en la <strong>fase de refactor</strong>. Una vez que nuestro código ya satisface los requisitos (porque pasa los tests), es cuando atacamos los otros 3 puntos (de las 4RSD):</p><ul><li>Eliminamos duplicidad e introducimos abstracciones (ayudándonos de heurísticas como la Regla del 3 u Object Calisthenics).</li><li>Mejoramos la legibilidad y expresividad del código.</li><li>Simplificamos el diseño, si es posible.</li></ul><h2 id=reflective-design>Reflective design</h2><p>La sutil clave de hacerlo de esta manera, es que hemos movido la actividad de diseño desde el momento en el que se <strong>escribe</strong> el código al momento en el que este se <strong>lee</strong>. En otras palabras, <strong>vamos a tomar decisiones de diseño sobre código ya escrito</strong>.</p><p>Este flujo de trabajo se conoce como <strong>reflective design</strong>. Se trata de, una vez que leemos el código escrito y <strong>funcionando</strong>, nos preguntamos: “¿Cómo puedo mejorar el diseño que me ha quedado?” y procedemos a refactorizarlo en consecuencia.</p><p>Este enfoque funciona muy bien, por los siguientes motivos:</p><ul><li>Vamos a <strong>reducir la complejidad accidental</strong>, ya que el diseño <strong>no va a incluir abstracciones innecesarias</strong>, puesto que es fruto de refactorizar un código que sabemos al 100% que es el código más sencillo para resolver el problema, por el hecho de haberlo escrito siguiendo la regla red=>green.</li><li>Cuando escribimos el código, <strong>ganamos conocimiento del dominio del problema</strong>, que a priori no teníamos. Al diseñar después, podemos incluir este conocimiento en el diseño, mejorando en consecuencia.</li><li><strong>Diseñamos de la misma manera</strong> cuando escribimos código greenfield que cuando cambiamos código legacy, por lo cual adoptamos un enfoque más consistente en la actividad de diseño.</li></ul><h2 id=cómo-aplicar-reflective-design>Cómo aplicar reflective design</h2><p>Para poder aplicar esta técnica de forma efectiva, necesitas varias cosas.</p><p>En primer lugar, tener <a href=https://www.exeal.com/cursos/diseno-orientado-a-objetos/>conocimientos de diseño</a> para saber “qué pinta tiene” un buen diseño. Conocer patrones de diseño, los principios SOLID, clean code, etc. Esta es la “parte fácil” y que seguro ya conoces, porque llevamos años hablando de esos temas en la industria. Hay decenas de libros y cientos de charlas y blogposts al respecto.</p><p>Lo realmente difícil es <strong>desarrollar un instinto</strong> para identificar problemas de diseño: identificar code smells. Llegar a tener una “intolerancia” por el código &ldquo;malo&rdquo;. Y esto lamentablemente sólo se puede conseguir:</p><ul><li>escribiendo y leyendo muchísimo código,</li><li>probando diferentes diseños,</li><li>equivocándose una y otra vez,</li><li>y aprendiendo de la experiencia.</li></ul><p>Lo que sí puedes hacer para practicar esto de forma deliberada, es intentar aplicar TDD de la siguiente manera:</p><ul><li>En primer lugar, cualquiera que sea tu idea inicial de diseño, <strong>olvídala</strong>.</li><li>Simplemente escribe tu test en rojo y <strong>pasa a verde lo antes posible</strong>.</li><li>Cuando empieces a notar que el código se te está yendo de las manos, que hay duplicidad, etc. etc., <strong>para un momento para pensar cómo podrías mejorarlo</strong>. Si no sabes cuándo parar, quizá pueda ser útil pairear con alguien más experimentado, como un <a href=https://www.exeal.com/>technical coach</a>, que te pueda guiar en el proceso hasta que desarrolles tú mismo este instinto.</li><li>Si estás 100% convencido de tu idea, aplícala. En cualquier otro caso, <strong>espérate</strong> y continúa con el flujo normal de TDD.</li></ul><h2 id=en-conclusión>En conclusión</h2><p>Mantener bajo control la complejidad en el desarrollo de software cuando un proyecto evoluciona es de los mayores desafíos a los que se puede enfrentar un desarrollador. Sin embargo, tenemos técnicas y metodologías como reflective design que nos pueden ayudar tanto a que un proyecto greenfield no se nos vaya de las manos, como a rescatar una base de código legacy, persiguiendo <strong>la simplicidad en el diseño</strong> cumpliendo las 4 rules of simple design para eliminar la complejidad accidental.</p><p>Esta técnica es relativamente sencilla de comenzar a adoptar, puesto que se basa en <strong>micro-hábitos como TDD y conocimientos de diseño</strong>, pero difícil de dominar, ya que requiere de <strong>tiempo y experiencia</strong> para desarrollar intuición sobre el código.</p></article></div><div class=container><div class="row h-100 align-items-center"><div class="col-12 text-center"><ul class="tags tags-dark"><li><a href=https://www.exeal.com/tags/legacy/>#legacy</a></li><li><a href=https://www.exeal.com/tags/refactoring/>#refactoring</a></li><li><a href=https://www.exeal.com/tags/oo-design/>#oo-design</a></li></ul><div class=post-author><img class=rounded-circle src=/assets/img/team/pedropardal.jpg><div class=post-author-name><h2>Pedro Pardal</h2><p>Founder, Software Craftsman & Technical Coach</p><ul class="social-icons list-inline"><li class=list-inline-item><a target=_blank href=https://twitter.com/ppardalj><img src=/assets/img/blog/social-icons/icon-twitter.svg></a></li><li class=list-inline-item><a target=_blank href=https://www.linkedin.com/in/pedro-pardal-jimena-36764344/><img src=/assets/img/blog/social-icons/icon-linkedin.svg></a></li><li class=list-inline-item><a target=_blank href=https://github.com/ppardalj><img src=/assets/img/blog/social-icons/icon-github.svg></a></li><li class=list-inline-item><a target=_blank href=mailto:pedro.pardal@exeal.com><img src=/assets/img/blog/social-icons/icon-email.svg></a></li></ul></div></div><div class=addthis_inline_share_toolbox></div></div></div></div></section><footer class=black><div class=container><div class="row align-items-center"><div class="col-lg-6 text-lg-left"><a href=/><img src=/assets/img/logo-exeal-footer.svg alt=Exeal></a><p><a href=/equipo/>Equipo</a> |
<a href=/jobs/extreme-programming-coach/>Empleo</a> |
<a href=/legal/legal-notice/>Aviso legal</a> |
<a href=/legal/cookie-policy/>Política de cookies</a> |
<a href=/legal/privacy-policy/>Política de privacidad</a></p></div><div class="col-lg-6 social-media"><ul class="list-inline text-lg-right mt-3 mt-lg-0"><li class=list-inline-item><a target=_blank href=https://twitter.com/exeal><img src=/assets/img/social/twitter.svg></a></li><li class=list-inline-item><a target=_blank href=https://www.linkedin.com/company/exeal/><img src=/assets/img/social/linkedin.svg></a></li><li class=list-inline-item><a target=_blank href=https://www.youtube.com/channel/UCxVspi-mashFr1RPGxSxEPA><img src=/assets/img/social/youtube.svg></a></li><li class=list-inline-item><a target=_blank href=https://github.com/exeal-es><img src=/assets/img/social/github.svg></a></li><li class=list-inline-item><a target=_blank href=mailto:hola@exeal.com><img src=/assets/img/social/email.svg></a></li></ul></div></div></div></footer><script src=https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js integrity=sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q crossorigin=anonymous></script>
<script src=https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js integrity=sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl crossorigin=anonymous></script>
<script src=/assets/js/scroll.js></script>
<script src=/assets/js/redirect.js></script>
<script src=/assets/js/console.js></script>
<script>function loadScript(t){var n=document.getElementsByTagName("head")[0],e=document.createElement("script");e.type="text/javascript",e.src="https://tracker.metricool.com/resources/be.js",e.onreadystatechange=t,e.onload=t,n.appendChild(e)}loadScript(function(){beTracker.t({hash:"45d30dfb71957d625ad900e4772a2d6a"})})</script><div class="modal fade" id=newsletter-modal tabindex=-1 role=dialog aria-hidden=true><div class="modal-dialog modal-lg modal-dialog-centered" role=document><div class=modal-content><div class=box style=margin:1.5rem;padding:3rem><div class="flap flap-top-right"></div><h2>¿Quieres descubrir las <em>10+1 claves que harán crecer tu carrera como desarrollador</em> en 2024?</h2><p>Déjanos tu nombre y tu mejor email y lo <em>recibirás directamente en tu bandeja de entrada</em>, junto a mucho más <em>contenido de valor</em>.</p><div id=mc_embed_shell><link href=//cdn-images.mailchimp.com/embedcode/classic-061523.css rel=stylesheet type=text/css><div id=mc_embed_signup><form action="https://exeal.us10.list-manage.com/subscribe/post?u=b43f7982f87d38bbb55bc64ae&id=a85eab802a&f_id=008ed9e5f0" method=post id=mc-embedded-subscribe-form name=mc-embedded-subscribe-form class=validate target=_blank><div id=mc_embed_signup_scroll><div class=indicates-required><span class=asterisk>*</span> campos requeridos</div><div class=mc-field-group><label for=mce-EMAIL>Tu mejor email <span class=asterisk>*</span></label><input type=email name=EMAIL class="required email" id=mce-EMAIL required></div><div class=mc-field-group><label for=mce-FNAME>Tu nombre <span class=asterisk>*</span></label><input type=text name=FNAME class="required text" id=mce-FNAME required></div><div id=mce-responses class="clear foot"><div class=response id=mce-error-response style=display:none></div><div class=response id=mce-success-response style=display:none></div></div><div aria-hidden=true style=position:absolute;left:-5000px>/* real people should not fill this in and expect good things
- do not remove this or risk form bot signups */
<input type=text name=b_b43f7982f87d38bbb55bc64ae_a85eab802a tabindex=-1></div><div class=optionalParent><div class="clear foot"><input type=submit name=subscribe id=mc-embedded-subscribe class=btn-submit value="Obtener las 10+1 claves"></div></div></div></form></div><script type=text/javascript src=//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js></script>
<script type=text/javascript>(function(){window.fnames=new Array,window.ftypes=new Array,fnames[0]="EMAIL",ftypes[0]="email",fnames[1]="FNAME",ftypes[1]="text",fnames[2]="LNAME",ftypes[2]="text",fnames[5]="JOBTITLE",ftypes[5]="text",fnames[6]="COMPANY",ftypes[6]="text",fnames[3]="ADDRESS",ftypes[3]="address",fnames[4]="PHONE",ftypes[4]="phone"})(jQuery);var $mcj=jQuery.noConflict(!0)</script></div><p><a href=# data-dismiss=modal style=color:grey;font-size:sm>No gracias, prefiero seguir estancado un año más.</a></p></div></div></div></div><script>if(typeof Storage!="undefined"){function showPopup(){window.setTimeout(function(){$("#newsletter-modal").modal("show"),sessionStorage.setItem("popup","hide")},1e4)}sessionStorage.getItem("popup")||sessionStorage.setItem("popup","show"),sessionStorage.getItem("popup")=="show"&&showPopup()}</script><script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5f2bf2edad69c454"></script></body></html>